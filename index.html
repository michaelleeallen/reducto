<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-dark.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>Reducto by michaelleeallen</title>
  </head>

  <body>
    <div id="container">
      <div class="inner">

        <header>
          <h1>Reducto</h1>
          <h2>A small module that aims to reduce the amount of code needed to create APIs with a distributed back end in express.js</h2>
        </header>

        <section id="downloads" class="clearfix">
          <a href="https://github.com/michaelleeallen/reducto/zipball/master" id="download-zip" class="button"><span>Download .zip</span></a>
          <a href="https://github.com/michaelleeallen/reducto/tarball/master" id="download-tar-gz" class="button"><span>Download .tar.gz</span></a>
          <a href="https://github.com/michaelleeallen/reducto" id="view-on-github" class="button"><span>View on GitHub</span></a>
        </section>

        <hr>

        <section id="main_content">
          <h1>
<a id="reducto" class="anchor" href="#reducto" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Reducto</h1>

<p><a href="https://travis-ci.org/michaelleeallen/reducto"><img src="https://travis-ci.org/michaelleeallen/reducto.png" alt="Build Status"></a></p>

<p><a href="https://david-dm.org/michaelleeallen/reducto"><img src="https://david-dm.org/michaelleeallen/reducto.svg" alt="devDependency Status"></a></p>

<p>A lightweight configuration framework for express.js that aims to simplify creating routes and APIs for apps with
a distributed back-end.</p>

<p>The main goal of reducto is to break apart the routing mechanism into smaller, more cohesive components. By reducing your app to middleware, data transforms, and reusable service calls you end up with a smaller set of code to reason about and thus make your app easier to write and maintain.</p>

<h2>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Installation</h2>

<pre><code>npm install reducto
</code></pre>

<h2>
<a id="project-setup" class="anchor" href="#project-setup" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Project Setup</h2>

<p>Reducto only provides configuration for express, so you will need to include express
yourself:</p>

<pre><code>npm install express --save
</code></pre>

<p>You must include a routes config that defines how to construct your app(see below). A services config is optional, but useful for connecting to distributed APIs.</p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> express <span class="pl-k">=</span> <span class="pl-c1">require</span>(<span class="pl-s"><span class="pl-pds">'</span>express<span class="pl-pds">'</span></span>);
<span class="pl-k">var</span> reducto <span class="pl-k">=</span> <span class="pl-c1">require</span>(<span class="pl-s"><span class="pl-pds">'</span>reducto<span class="pl-pds">'</span></span>);
<span class="pl-k">var</span> app <span class="pl-k">=</span> <span class="pl-en">express</span>();
<span class="pl-k">var</span> routes <span class="pl-k">=</span> <span class="pl-c1">require</span>(<span class="pl-s"><span class="pl-pds">'</span>your_route_config.json<span class="pl-pds">'</span></span>);
<span class="pl-k">var</span> services <span class="pl-k">=</span> <span class="pl-c1">require</span>(<span class="pl-s"><span class="pl-pds">'</span>your_services_config.json<span class="pl-pds">'</span></span>);

<span class="pl-en">reducto</span>(app, routes, services);

<span class="pl-smi">app</span>.<span class="pl-en">listen</span>(<span class="pl-c1">3000</span>);</pre></div>

<h2>
<a id="routes" class="anchor" href="#routes" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Routes</h2>

<p>Routes can be configured to use middleware, views, fixtures and service calls. Each piece is optional, and should be added in the order you want them to run:</p>

<div class="highlight highlight-source-json"><pre>{
  <span class="pl-s"><span class="pl-pds">"</span>/my/route/:id<span class="pl-pds">"</span></span>: {
    <span class="pl-s"><span class="pl-pds">"</span>GET<span class="pl-pds">"</span></span>: [
      { <span class="pl-s"><span class="pl-pds">"</span>type<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>middleware<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>path<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>./lib/middleware.js#myFuncName<span class="pl-pds">"</span></span> },
      { <span class="pl-s"><span class="pl-pds">"</span>type<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>service<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>GET:myEndpoint<span class="pl-pds">"</span></span> },
      { <span class="pl-s"><span class="pl-pds">"</span>type<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>fixture<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>data<span class="pl-pds">"</span></span>: {
        <span class="pl-s"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>My awesome page title<span class="pl-pds">"</span></span>
      }},
      { <span class="pl-s"><span class="pl-pds">"</span>type<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>view<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>my-view<span class="pl-pds">"</span></span> }
    ],
    <span class="pl-s"><span class="pl-pds">"</span>POST<span class="pl-pds">"</span></span>: [
      { <span class="pl-s"><span class="pl-pds">"</span>type<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>service<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>POST:myEndpoint<span class="pl-pds">"</span></span> },
      { <span class="pl-s"><span class="pl-pds">"</span>type<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>transform<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>path<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>./lib/my-post-transform.js<span class="pl-pds">"</span></span> }
    ]
  }
}</pre></div>

<p>Each route is defined by its URI pattern. This can be any legal express route pattern. Next you define
the HTTP methods per route. Each method has its own list of configurations.</p>

<h3>
<a id="middleware" class="anchor" href="#middleware" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>middleware</h3>

<h4>
<a id="path" class="anchor" href="#path" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>path</h4>

<p>The file path to the middleware file(with optional function name as <em>file.js#myFuncName</em>), or the name of any 3rd-party express middleware</p>

<h3>
<a id="service" class="anchor" href="#service" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>service</h3>

<h4>
<a id="name" class="anchor" href="#name" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>name</h4>

<p>The name of service endpoint from your services config file.</p>

<h3>
<a id="transform" class="anchor" href="#transform" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>transform</h3>

<h4>
<a id="path-1" class="anchor" href="#path-1" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>path</h4>

<p>The file path to the transform function(with optional function name as <em>file.js#myFuncName</em>).</p>

<h3>
<a id="fixture" class="anchor" href="#fixture" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>fixture</h3>

<h4>
<a id="data" class="anchor" href="#data" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>data</h4>

<p>A JSON object containing static data. This data is added to the cumulative <code>res.locals</code> object.</p>

<h3>
<a id="view" class="anchor" href="#view" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>view</h3>

<h4>
<a id="name-1" class="anchor" href="#name-1" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>name</h4>

<p>The name of a view to render with <code>res.render</code>. You must provide express with a rendering engine for this to work. See examples.</p>

<h2>
<a id="services" class="anchor" href="#services" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Services</h2>

<p>Services, or rather, service calls, represent any callable HTTP endpoint. Right now only RESTful enpoints are supported.</p>

<div class="highlight highlight-source-json"><pre>{
  <span class="pl-s"><span class="pl-pds">"</span>myEndpoint<span class="pl-pds">"</span></span>: {
    <span class="pl-s"><span class="pl-pds">"</span>GET<span class="pl-pds">"</span></span>: {
      <span class="pl-s"><span class="pl-pds">"</span>uri<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>http://myws.com/api/someresource/{id}<span class="pl-pds">"</span></span>,
      <span class="pl-s"><span class="pl-pds">"</span>headers<span class="pl-pds">"</span></span>: {
        <span class="pl-s"><span class="pl-pds">"</span>api-key<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>adlfplkjf09123lkj32lkj3<span class="pl-pds">"</span></span>
      }
    },
    <span class="pl-s"><span class="pl-pds">"</span>POST<span class="pl-pds">"</span></span>: {
      <span class="pl-s"><span class="pl-pds">"</span>uri<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>http://myws.com/api/someresource<span class="pl-pds">"</span></span>
    }
  }
}</pre></div>

<p>Note that the route config is using
the express routing mechanism for parameters: <code>/my/route/:id</code>. This data can then be used in our service calls by
placing a corresponding URI token in the service definition: <code>http://myws.com/api/someresource/{id}</code> where <code>{id}</code>
will map to <code>:id</code>.</p>

<p>Service calls use <a href="https://github.com/mikeal">mikeal's</a> <a href="https://github.com/mikeal/request">request</a> module to handle HTTP, so any valid configuration for
<strong>request</strong> applies here.</p>

<h2>
<a id="data-transforms" class="anchor" href="#data-transforms" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Data Transforms</h2>

<p>Transforms are any module/method that accepts JSON as input and produces JSON as output. Transforms will be passed in the cumulative <code>res.locals</code> object.</p>

<div class="highlight highlight-source-js"><pre><span class="pl-c1">module</span>.<span class="pl-en">exports</span> <span class="pl-k">=</span> <span class="pl-k">function</span>(<span class="pl-smi">data</span>){
  <span class="pl-c">// do some modification on data ...</span>
  <span class="pl-k">return</span> data;
};</pre></div>

<p>These are great for when you need the data in a different format than what the service(which you may have no control over) provides.</p>

<h2>
<a id="examples" class="anchor" href="#examples" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Examples</h2>

<p>Navigate to the root directory and run <code>npm start</code>. This will start the example app at
<code>http://localhost:3000</code>. You can view the example page by pointing your browser to <code>http://localhost:3000/weather/:zipcode</code>
where <code>:zipcode</code> is any valid zip. The resulting page should show you the weather for that zipcode.</p>
        </section>

        <footer>
          Reducto is maintained by <a href="https://github.com/michaelleeallen">michaelleeallen</a><br>
          This page was generated by <a href="https://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.
        </footer>

        
      </div>
    </div>
  </body>
</html>
